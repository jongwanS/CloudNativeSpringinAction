# 3. 클라우드 네이티브 개발 시작
> **이 장의 주요 내용**
> - 클라우드 네이티브 프로젝트의 부트스트래핑
> - 임베디드 서버와 톰캣을 사용한 작업
> - 스프링 MVC를 사용한 RESTful 애플리케이션 구축
> - 스프링 테스트를 사용한 RESTful 애플리케이션 테스트
> - 깃허브 액션을 사용한 빌드 및 테스트 자동화

## 3.1 클라우드 네이티브 프로젝트 부트스트래핑
- 15요소 방법론에는 클라우드 네이티브 애플리케이션을 부트스트랩할 때 필요한 몇 가지 실용적인 지침
- **하나의 코드베이스, 하나의 애플리케이션**(one codebase, one application)
  - `클라우드 네이티브 애플리케이션`은 **하나의 코드베이스로 관리**해야 한다.
- **의존성 관리**(dependency management)
  - `클라우드 네이티브 애플리케이션`은 **의존성을 명시적으로 관리하는 도구를 사용**해야 한다.

### 3.1.1 하나의 코드베이스, 하나의 애플리케이션
- `클라우드 네이티브 애플리케이션`은 **단일 코드베이스로 관리**해야 한다.
  - 여러 환경에 배포할 수 있는 **불가변 아티팩트**, 즉 **빌드(build)를 생성**해야 한다.
- `환경에 종속적인 모든 설정`은 애플리케이션 코드베이스의 외부에 있어야 한다.
- `분산된 모놀리스`가 되지 않도록 신중하게 판단해야 한다.
  - 코드가 두 개 이상의 애플리케이션에서 사용된다면, 독립적인 서비스 의존성 라이브러리로 분리해야 한다.

### 3.1.2 그래들과 메이븐의 의존성 관리
- 자바에서 의존성 관리를 ㅜ이해 가장 많이 사용하는 도구는 **그래들**과 **메이븐**이다.
  - `그래들` 및 `메이븐`은 빌드/테스트 등도 제공한다.
- 의존성 매니페스트 파일과 함께 **의존성 관리자**도 있어야 한다.
  - `gradlew`, `mvnw` 라는 **래퍼 스크립트**로 **의존성 관리툴을 실행**할 수 있다.
  - `gradle build` 명령 실행대신 `./gradlew build` 를 실행할 수 있다.
- ````shell
  dependencies {
      implementation 'org.springframework.boot:spring-boot-starter-web'
      testImplementation 'org.springframework.boot:spring-boot-starter-test'
  }
  ````
  - 스프링 웹(spring-boot-starter-web)
    - 스프링 MVC로 웹 애플리케이션을 구축하는 데 필요한 라이브러리 제공
    - 톰캣을 임베디드 서버로 포함하도록 기본설정
    - 의존성 라이브러리 덕분에 개발자는 더 많은 의존성을 관리하지 않아도 된다.
  - 스프링 부트 테스트(spring-boot-starter-test)
    - 스프링 테스트(Spring Test), JUnit, 어서트J, 모키토등 여러 라이브러리 및 유틸리티를 제공한다.

## 3.2 임베디드 서버로 작업
- WAR, EAR로 패키징후 톰캣과 같은 웹서버에 애플리케이션 배포 => `서버에 대한 외부 의존성` 
  - 애플리케이션 자체의 이식성과 발전을 제한
  - 유지 보수 비용 증다 
- 포트 바인딩(port binding)
  - 클라우드 네이티브 애플리케이션은 독립적이고 환경에 따라 설정 가능한 포트로 바인딩해서 서비스를 외부로 제공할 수 있다.
- 동시성(concurrency)
  - 인스턴스를 더 많이 배포해 워크로드를 분산하는 것을 선호한다.

### 3.2.1 실행 가능한 JAR 및 임베디드 서버 
### 3.2.2 요청당 스레드 모델 이해
### 3.2.3 내장 톰캣 설정
#### 1. HTTP 포트
#### 2. 연결 타임아웃
#### 3. 스레드 풀

## 3.3 스프링 MVC를 이용한 RESTful 애플리케이션 구축
### 3.3.1 REST API를 먼저, 비지니스 로직은 그다음
#### 1. 도메인 개체 정의
#### 2. 사용 사례 구현
#### 3. 데이터 액세스를 위해 리포지터리 추상화
#### 4. 도메인 오류를 알리기 위한 예외의 사용





## Useful Commands

| Gradle Command	         | Description                                   |
|:---------------------------|:----------------------------------------------|
| `./gradlew bootRun`        | Run the application.                          |
| `./gradlew build`          | Build the application.                        |
| `./gradlew test`           | Run tests.                                    |
| `./gradlew bootJar`        | Package the application as a JAR.             |
| `./gradlew bootBuildImage` | Package the application as a container image. |